<!DOCTYPE html>
<html lang="pt-br">





<head>
       <title>Chat</title>
       <link rel = "stylesheet" href = "../css/chat.css">

       <script>
        document.addEventListener("DOMContentLoaded", () => {
          const user = sessionStorage.getItem("user");
          console.log("UsuÃ¡rio encontrado:", user); // ðŸ‘ˆ DiagnÃ³stico
      
          if (!user) {
            alert("VocÃª precisa realizar o login para acessar.");
            window.location.href = "/";
          } else {
            alert(`Bem-vindo(a), ${user}!`);
          }
        });
      </script>
</head>

<body>
       <div class="main-container">
         <!-- Lado esquerdo: HistÃ³rico do chat -->
         <div class="chat-history">
         </div>
     
         <!-- Lado direito: Sidebar existente -->
         <div class="sidebar">
           <div class="hotbar">
             <button id="btn1">Ficha</button>
             <button id="btn2">ConfiguraÃ§Ãµes</button>
             <button id="btn3">Sair</button>
           </div>
     
           <div class="chat-container">
              <textarea id="chatInput" placeholder="Digite sua mensagem..." class="chat-input"></textarea>
              <button id="sendGeral" class="chat-send">Enviar (Geral)</button>
              <button id="sendDM" class="chat-send">Enviar (DM)</button>              
           </div>
         </div>
       </div>

       <script>
              const input = document.getElementById('chatInput');
              const btnSendGeral = document.getElementById('sendGeral');
              const chatHistory = document.querySelector('.chat-history');
            
              btnSendGeral.addEventListener('click', () => {
                let texto = input.value.trim();
            
                if (texto !== '') {
                  // Verifica expressÃµes entre colchetes e avalia cada uma
                  const expressaoRegex = /\[([^\[\]]+)\]/g;
                  texto = texto.replace(expressaoRegex, (match, expr) => {
                    try {
                      // Usa eval com cuidado (apenas para expressÃµes simples)
                      const resultado = eval(expr);
                      return resultado;
                    } catch (e) {
                      return '[erro]';
                    }
                  });
            
                  // Cria a nova mensagem
                  const novaMensagem = document.createElement('div');
                  novaMensagem.classList.add('chat-message');
                  novaMensagem.textContent = `[VocÃª]: ${texto}`;
            
                  chatHistory.appendChild(novaMensagem);
                  chatHistory.scrollTop = chatHistory.scrollHeight;
                  input.value = '';
                }
              });
            </script>
            
            

     </body>
     
     





</html>